---
title: Verwalten von Surface Dock 2 mit WMI
description: In diesem Artikel wird erläutert, wie Sie mithilfe von WMI die neueste Firmware, den aktuellen Richtlinienzustand und zugehörige Daten auf Surface Dock 2-Geräten Remote überwachen und verwalten.
ms.prod: w10
ms.mktglfcycl: manage
ms.localizationpriority: medium
ms.sitesec: library
author: coveminer
ms.author: greglin
ms.topic: article
ms.date: 10/12/2020
ms.reviewer: hachidan
manager: laurawi
audience: itpro
ms.openlocfilehash: 06933d49e99862fb19d0f6a09c9680a127b755cd
ms.sourcegitcommit: c1efb75e8524193bdc0a5f7496dc23a92ac665c8
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/12/2020
ms.locfileid: "11114653"
---
# Verwalten von Surface Dock 2 mit WMI

Die Windows-Verwaltungsinstrumentation (WMI)-Unterstützung bietet einen umfassenden Satz an Diagnoseinformationen, mit denen IT-Administratoren die neueste Firmware, den aktuellen Richtlinienzustand und zugehörige Daten über Surface Dock 2-Geräte remote überwachen und verwalten können. Sie können WMI mit Windows PowerShell, System Center Operations Manager und anderen Tools verwenden. Weitere Informationen zu WMI finden Sie unter [Arbeiten mit WMI](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true). 

Zum Aktivieren der WMI-Unterstützung wechseln Sie zu [Surface Dock 2-Treiber und-Firmware](https://www.microsoft.com/download/details.aspx?id=101317) , und laden Sie das entsprechende Paket herunter:

**SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;Version # C1_x64.msi:**<br>

- Surface pro (fünfte Generation und höher)
- DGM-Buch (2nd Generation und höher)
- Surface Go (alle Generationen)
- Surface Laptop (alle Generationen)
- Surface Laptop go

 **SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;Version # C1_arm64.msi:** <br>

- Surface Pro X

## Verwenden von WMI mit Surface Dock 2

1. So zählen Sie alle Instanzen von Dock-Komponenten auf:

    ```PowerShell
    Get-CimInstance -Namespace "root/Surface" -Class "SurfaceDockComponent" 
    ```
2. Wenn Sie auf WMI-Klassen Eigenschaftenbeschreibungen zugreifen möchten, öffnen Sie eine Eingabeaufforderung, und geben Sie WMI-Befehle ein, wobei **Eigenschaft** eine der in Tabelle 1 aufgeführten Eigenschaften ist.

    ```PowerShell
     Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["<Property>"]
    ```

- **Beispiel:** Geben Sie Folgendes ein, um auf die Beschreibung für die CIM-Eigenschaft ( **Version** Common Information Model) zuzugreifen:
    ```PowerShell
    (Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["Version"].Qualifiers["Description"].Value
    ```
 
 ### Tabelle1. Surface Dock 2-WMI-Referenz

| Eigenschaft         | Typ   | Erwarteter Wert (e)                                                                                                                                                                                                            | Beschreibung                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ComponentName    | Zeichenfolge | Mikrocontroller <br>"USB-Hub 1" <br>"USB-Hub 2" <br>"Display-Port-Hub" <br>"Power Delivery Controller" <br>"Audio-Codec" <br>"Ethernet-Controller"                                                                         | Die folgende Eigenschaft listet den spezifischen Namen der Gerätekomponente auf, der die zugehörigen CIM-Kurs Daten (Common Information Model) entsprechen.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| DeviceName       | Zeichenfolge | "Surface Dock 1" <br>"Surface Dock 2"                                                                                                                                                                                        | Die folgende Eigenschaft enthält den Namen des Dock-Geräts, zu dem die bestimmte Gerätekomponente gehört.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DockSerialNumber | Zeichenfolge | Eine fortlaufende Zahl von zwölf (12) Ziffern, die nur numerische Werte enthält                                                                                                                                                           | Die folgende Eigenschaft zeichnet die Seriennummer des angeschlossenen Dock Geräts auf. Diese Seriennummer ist für jede Komponente exakt identisch, wenn Sie zum gleichen Dock-Gerät gehören. Als Referenz kann diese Seriennummer physisch auf der Unterseite des Surface Dock selbst gefunden werden.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ID               | UInt16 | 0, 1, 2,..., 65535                                                                                                                                                                                                          | Die folgende Eigenschaft ist eine eindeutige ID, die von NULL (0) startet und aufzählt. Diese Variable wird verwendet, um die aufgelisteten WMI-Instanzen zu nummerieren.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| LastUpdateStatus | Zeichenfolge | Erfolg <br>"PendingDockReattach" <br>Fehlgeschlagen                                                                                                                                                                             | Die folgende Eigenschaft gibt den letzten versuchten CFU-Status (Component Firmware Update) für die fragliche Gerätekomponente an. Mögliche Werte sind: **Erfolg,** **ausstehende Dock erneut anfügen** und **Fehler.**<br><br><br>- **Erfolg** zeigt an, dass die zuvor angewendete neue Firmware erfolgreich angewendet wurde.<br>- **Ausstehend Dock erneut anfügen** gibt an, dass für die Gerätekomponente ein neues Update aussteht, und der Benutzer muss den Surface Connector des Docks trennen und erneut anfügen, um das neue Update anzuwenden.<br>- **Fehler** : gibt an, dass ein möglicher rechtmäßiger Fehler während des CFU-Prozesses aufgetreten ist oder dass das Peripheriegerät in der erwarteten Version nicht gestartet wurde. Bei einem **fehlerhaften** Fall ist dies kein Hinweis darauf, dass das Gerät nicht funktioniert, sondern eher Fehler beim Versuch, das Gerät zu aktualisieren. In diesem Fall wird die vorherige Firmware weiterhin ausgeführt.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| PolicyState      | Zeichenfolge | Aktiviert <br>Deaktiviert                                                                                                                                                                                                     | Die folgende Eigenschaft gibt die aktuelle Semm-Richtlinie (Surface Enterprise Management Mode) für die Gerätekomponente an. Mögliche Werte sind: **aktiviert** und **deaktiviert.**<br><br><br>- **Aktiviert** gibt an, dass das Semm-System dem Host Gerät den Zugriff auf und die Verwendung der Gerätekomponente gestattet hat.<br>- **Deaktiviert** gibt an, dass das Semm-System nicht zulässig ist, und verhindert dadurch, dass der Hostcomputer auf die Gerätekomponente zugreifen und diese verwenden kann.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProductId        | Zeichenfolge [] | Eine Liste von Hex-Zeichenfolgen, die jeweils zwischen "0x0000" und "0xFFFF" liegen können                                                                                                                                                        | Mit der folgenden Eigenschaft wird die Produkt-ID (PID) der Gerätekomponente klassifiziert. Es ist möglich, dass mehr als eine PID aufgeführt ist. Bei einem USB-Hub werden beispielsweise sowohl Super Speed (SS)-als auch Hochgeschwindigkeits-Geräte (HS) in einem singulären "Hub" gebündelt. Daher würden zwei (2) PIDs in diesem Array aufgeführt.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProvisionedState         | boolean | Wahr oder falsch                                                                                                                                                        | Die folgende Eigenschaft beschreibt den bereitgestellten Zustand des Surface Enterprise Management Mode (Semm) des Surface Dock-Geräts. Der bereitgestellte Zustand ist für jede Komponente exakt identisch, wenn Sie zum gleichen Dock-Gerät gehören. Mögliche Werte sind: wahr oder falsch. Der Wert "true" gibt an, dass das Surface Dock-Gerät zurzeit verwaltet wird und dadurch die Port Funktionalität eingeschränkt sein kann. Weitere Informationen finden Sie im Eigenschaftenfeld "PolicyState". Der Wert false gibt an, dass das Surface Dock-Gerät zurzeit nicht verwaltet wird und keine Funktionseinschränkungen auferlegt wurden.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Status           | Zeichenfolge | OK <br>Getrennt <br>Fehler <br>Fehlt <br>"DeviceHandleInUse" <br>Deaktiviert <br>"NotSupportedByWmi"                                                                                                             | Die folgende Eigenschaft beschreibt den Zustand der Dock-Verbindung mit dem Hostcomputer. Mögliche Werte sind: **OK,** **getrennt,** **Fehler,** **Fehlend** , **DeviceHandleInUse,**  **deaktiviert** und **NotSupportedByWmi.** <br>- **OK** zeigt an, dass das Gerät erfolgreich mit dem Hostcomputer verbunden ist, und es gibt keine Probleme, die dessen Funktionalität hemmen würden. <br>- " **Getrennt** " gibt an, dass der Surface-Verbinder, der die Verbindung für alle Gerätekomponenten bereitstellt, derzeit nicht an den Hostcomputer angefügt ist. <br>- **Fehler** weist auf ein potenzielles Problem mit der Geräteinstanz hin, und die Geräteschnittstelle wurde mehr als wahrscheinlich mit einem gelben Ausrufezeichen im Geräte-Manager gekennzeichnet – überprüfen Sie die **Statuscode** -Eigenschaft, um detailliertere Informationen zur Art des aufgetretenen Fehlers zu erhalten. <br>- **Fehlt** gibt an, dass das Gerät auf dem Hostcomputer aufgezählt wurde, aber aus irgendeinem Grund nicht. Die **Statuscode** -Eigenschaft hält den Wert 24, um diese fehlerhafte Situation anzugeben.<br>- **DeviceHandleInUse** gibt an, dass ein anderer Prozess derzeit mit dem Gerät kommuniziert, wodurch dieser WMI-Instanzenanbieter (Windows Management Instrumentation) von seinen Kommunikationsanforderungen absieht. Versuchen Sie erneut, Ihren WMI-Befehl auszuführen! <br> - **Deaktiviert** gibt an, dass die aktuelle Richtlinie für den Semm (Surface Enterprise Management Mode) nicht zulässig ist, und verhindert dadurch, dass der Hostcomputer auf die Gerätekomponente zugreifen und diese verwenden kann. Weitere Informationen finden Sie im **PolicyState** -Eigenschaftenfeld.<br>- **NotSupportedByWmi** gibt an, dass das angeschlossene Dock zurzeit nicht von diesem WMI-Anbieter unterstützt wird. Dieser Status wird für das Surface Dock 1 angezeigt, das derzeit nicht von diesem WMI-Instanzenanbieter unterstützt wird.|
| Statuscode       | UInt32 | [Geräte-Manager-Fehler Code](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages) , der aus der CIM_LogicalDevice WMI-Klasse abgerufen wurde (innerhalb von *cimwin32. MOF*) | Die folgende Eigenschaft bietet den Geräte-Manager-Fehlercode für die angegebene Dock-Komponente. Der Wert 0 (null) gibt an, dass die Dock-Komponente ordnungsgemäß funktioniert. ein Wert, der größer als 0 (null) ist, gibt ein Problem oder einen möglichen Fehler mit der Dock-Komponente an. Da die Dock-Komponente mit mehreren Geräteschnittstellen aufzählen kann, ist es möglich, dass weitere Fehlercodes für den Geräte-Manager vorhanden sind. Dieses Eigenschaftenfeld listet nur einen einzelnen Fehlercode auf, auch wenn mehrere verfügbar sind. Der Geräte-Manager beschriftet das Gerät nur dann mit einem gelben Ausrufezeichen, wenn bestimmte Fehlercodes aufgetreten sind.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| VendorID         | Zeichenfolge | Eine Hex-Zeichenfolge, die zwischen "0x0000" und "0xFFFF" liegen kann                                                                                                                                                                        | Die folgende Eigenschaft stellt die spezifische Vendor-ID (vid) der Gerätekomponente dar.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Version          | Zeichenfolge | Eine Versionszeichenfolge, die das Formular wie folgt enthält: "x. y. z", wobei x, y und z numerische Werte sind.                                                                                                                            | Die folgende Eigenschaft gibt die aktuelle Version der Firmware an, die derzeit auf der Gerätekomponente ausgeführt wird.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |


## Mehr erfahren

- [Sichern von Surface Dock 2-Ports mit SEMM](secure-surface-dock-ports-semm.md)
- [Neuerungen in Surface Dock 2](surface-dock-whats-new.md)
- [Fehlercodes des Geräte-Managers](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages)
- [Arbeiten mit WMI](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true)
